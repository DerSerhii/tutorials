# Django ORM

***Django ORM*** (Object-Relational Mapping) — это инструмент фреймворка Django, который позволяет 
взаимодействовать с базами данных, используя высокоуровневые методы Python, а не SQL-запросы. 

Он относится к типу ORM, который реализует шаблон Active Record. 
Общая суть шаблона в том, что каждой таблице в приложении соответствует одна модель.

## QuerySet
***QuerySet*** — это результат выполнения запроса к базе данных, представляющий коллекцию объектов 
модели Django.  
`<QuerySet [<Product: Corus>, <Product: Fluxi 2000/TZ>]>`

`<class 'django.db.models.query.QuerySet'>`предоставляет API для выполнения запросов к базе данных и взаимодействия
с данными. Он обладает множеством методов, которые позволяют осуществлять разнообразные операции, такие как 
фильтрация, сортировка, ограничение количества результатов, объединение данных из разных таблиц и другие.

Примеры некоторых методов QuerySet в Django ORM:

* `filter()`: применяет фильтрацию к QuerySet на основе заданных условий.
* `exclude()`: исключает объекты, которые не соответствуют заданным условиям.
* `order_by()`: сортирует объекты по указанному полю или нескольким полям.
* `annotate()`: добавляет агрегированные значения к каждому объекту QuerySet.
* `values()`: возвращает QuerySet, содержащий только определенные поля объектов модели.
* `count()`: возвращает количество объектов в QuerySet.
* `first()`: возвращает первый объект из QuerySet.
* `delete()`: удаляет объекты, соответствующие QuerySet, из базы данных.

**QuerySet** является ***ленивым***, что означает, что выполнение фактического запроса к базе данных происходит
только тогда, когда это необходимо, например, при итерации по объектам или вызове методов, таких как
`list()`, `get()`, `count()` и других.

#### Lookups

Так же у каждого поля существуют встроенные системы лукапов, 
пишутся с таким же синтаксисом как и доступ к вложенным объектам<br>
`field__lookuptype=value`

Стандартные лукапы:<br>
`lte` - меньше или равно

`gte` - больше или равно

`lt` - меньше

`gt` - больше

`startswith` - Начинается с

`istartswith` - Начинается с, без учёта регистра

`endswith` - Заканчивается на

`iendswith` - Заканчивается на, без учёта регистра

`range` - находится в рамках

`week_day` - день недели (для дат)

`year` - год (для дат)

`isnull` - является наном

`contains` - частично содержит учитывая регистр ("Всем привет, я Влад" содержит слово "Влад", но не содержит "влад")

`icontains` - то же самое, но регистро независимо, теперь найдется и второй вариант.

`exact` - совпадает (не обязательный лукап, делает то же, что и знак равно)

`iexact` - совпадает регистро независимо (по запросу "привет" найдет и "Привет" и "прИвЕт")

`in` - содержится в каком то списке

<hr>

Лекция [тут](https://github.com/PonomaryovVladyslav/PythonCources/blob/master/lesson31.md#%D1%83%D1%80%D0%BE%D0%BA-31-django-orm-%D0%BE%D0%B1%D1%8A%D0%B5%D0%BA%D1%82%D1%8B-%D0%BC%D0%BE%D0%B4%D0%B5%D0%BB%D0%B5%D0%B9-%D0%B8-queryset-meta-%D0%BC%D0%BE%D0%B4%D0%B5%D0%BB%D0%B5%D0%B9-%D0%BF%D1%80%D0%BE%D0%BA%D1%81%D0%B8-%D0%BC%D0%BE%D0%B4%D0%B5%D0%BB%D0%B8)

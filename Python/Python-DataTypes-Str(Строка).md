# String (строки)

***Str (Строки)*** — упорядоченные последовательности символов, используемые для хранения и представления 
текстовой информации, поэтому с помощью строк можно работать со всем, что может быть представлено в текстовой форме.

### Литералы строк

#### Строки в апострофах и в кавычках
```
s = 'spam"s'
s = "spam's"
```
Строки в апострофах и в кавычках - одно и то же. <br> 
Причина наличия двух вариантов в том, чтобы позволить вставлять в литералы строк символы кавычек или апострофов, 
не используя экранирование

#### Экранированные последовательности - служебные символы
`\n` — перевод строки <br>
`\a` — звонок <br>
`\b` — забой <br>
`\f` — перевод страницы <br>
`\r` — возврат каретки <br>
`\t` — горизонтальная табуляция <br>
`\v` — вертикальная табуляция <br>
`\N{id}` — идентификатор ID базы данных Юникода <br>
`\uhhhh` — 16-битовый символ Юникода в 16-ричном представлении <br>
`\Uhhhh…` — 32-битовый символ Юникода в 32-ричном представлении <br>
`\xhh` — 16-ричное значение символа <br>
`\ooo` — 8-ричное значение символа <br>
`\0` — символ Null (не является признаком конца строки) <br>

#### "Сырые" строки - подавляют экранирование

Если перед открывающей кавычкой стоит символ 'r' (в любом регистре), то механизм экранирования отключается.
```python
s = r'C:\newt.txt'
```
Но, несмотря на назначение, "сырая" строка не может заканчиваться символом обратного слэша. Пути решения:
```python
s = r'\n\n\\'[:-1]
s = r'\n\n' + '\\'
s = '\\n\\n'
```
#### Строки в тройных апострофах или кавычках

Главное достоинство строк в тройных кавычках в том, что их можно использовать для записи многострочных блоков текста. 
Внутри такой строки возможно присутствие кавычек и апострофов, главное, чтобы не было трех кавычек подряд.
```python
>>> c = '''это очень большая
... строка, многострочный
... блок текста'''
>>> c
'это очень большая\nстрока, многострочный\nблок текста'
>>> print(c)
это очень большая
строка, многострочный
блок текста
```

### Базовые операции

Конкатенация (сложение):
```
>>> S1 = 'spam'
>>> S2 = 'eggs'
>>> print(S1 + S2)
'spameggs'
```
Дублирование строки:
```
>>> print('spam' * 3)
spamspamspam
```
Длина строки (функция len):
```
>>> len('spam')
4
```
Доступ по индексу:
```
>>> S = 'spam'
>>> S[0]
's'
>>> S[2]
'a'
>>> S[-2]
'a'
```
Извлечение среза: <br>
Оператор извлечения среза: [X:Y]. X – начало среза, а Y – окончание;
символ с номером Y в срез не входит. По умолчанию первый индекс равен 0,
а второй - длине строки.
```
>>> s = 'spameggs'
>>> s[3:5]
'me'
>>> s[2:-2]
'ameg'
>>> s[:6]
'spameg'
>>> s[1:]
'pameggs'
>>> s[:]
'spameggs'
```
Кроме того, можно задать шаг, с которым нужно извлекать срез.
```
>>> s[::-1]
'sggemaps'
>>> s[3:5:-1]
''
>>> s[2::2]
'aeg'
```
При вызове методов необходимо помнить, что строки в Python относятся к категории неизменяемых последовательностей,
то есть все функции и методы могут лишь создавать новую строку.
```
>>> s = 'spam'
>>> s[1] = 'b'
Traceback (most recent call last):
  File "", line 1, in
    s[1] = 'b'
TypeError: 'str' object does not support item assignment
>>> s = s[0] + 'b' + s[2:]
>>> s
'sbam'
```
## Функции и методы строк
`S = 'str'`; `S = "str";` `S = '''str'''`; `S = """str"""` — литералы строк

`S = "s\np\ta\nbbb"` — экранированные последовательности

`S = r"C:\temp\new"` — неформатированные строки (подавляют экранирование)

`S = b"byte"` — строка байтов

`S1 + S2` — конкатенация (сложение строк)

`S1 * 3` — повторение строки

`S[i]` — обращение по индексу

`S[i:j:step]` — извлечение среза

`len(S)` — длина строки

`S.find(str, [start], [end])` — поиск подстроки в строке. Возвращает номер первого вхождения или -1

`S.rfind(str, [start], [end])` — поиск подстроки в строке. Возвращает номер последнего вхождения или -1

`S.index(str, [start], [end])` — поиск подстроки в строке. Возвращает номер первого вхождения или вызывает `ValueError`

`S.rindex(str, [start], [end])` — поиск подстроки в строке. Возвращает номер последнего вхождения или вызывает `ValueError`

`S.replace(шаблон, замена[, maxcount])`	— замена шаблона на замену. maxcount ограничивает количество замен

`S.split(символ)` — разбиение строки по разделителю

`S.isdigit()` — состоит ли строка из цифр

`S.isalpha()` — состоит ли строка из букв

`S.isalnum()` — состоит ли строка из цифр или букв

`S.islower()` — состоит ли строка из символов в нижнем регистре

`S.isupper()` — состоит ли строка из символов в верхнем регистре

`S.isspace()` — состоит ли строка из неотображаемых символов (пробел, символ перевода страницы ('\f'), "новая строка" ('\n'), "перевод каретки" ('\r'), "горизонтальная табуляция" ('\t') и "вертикальная табуляция" ('\v'))

`S.istitle()` — начинаются ли слова в строке с заглавной буквы

`S.upper()`	— преобразование строки к верхнему регистру

`S.lower()`	— преобразование строки к нижнему регистру

`S.startswith(str)`	 — начинается ли строка `S` с шаблона `str`

`S.endswith(str)` — заканчивается ли строка `S` шаблоном `str`

`S.join(список)` — сборка строки из списка с разделителем `S`

`ord(символ)` — символ в его код ASCII

`chr(число)` — код ASCII в символ

- `str.capitalize()` — переводит первый символ строки в верхний регистр, 
а все остальные в нижний.
```python
>>> s
'pythonPYTHON'
>>> s.capitalize()
'Pythonpython'
```
`S.center(width, [fill])` — возвращает отцентрованную строку, по краям которой стоит символ `fill` (пробел по умолчанию)

`S.count(str, [start], [end])` — возвращает количество непересекающихся вхождений подстроки в диапазоне [начало, конец] (0 и длина строки по умолчанию)

`S.expandtabs([tabsize])` — возвращает копию строки, в которой все символы табуляции заменяются одним или несколькими пробелами, в зависимости от текущего столбца. Если TabSize не указан, размер табуляции полагается равным 8 пробелам

`S.lstrip([chars])` — удаление пробельных символов в начале строки

`S.rstrip([chars])` — удаление пробельных символов в конце строки

`S.strip([chars])` — удаление пробельных символов в начале и в конце строки

`S.partition(шаблон)` — возвращает кортеж, содержащий часть перед первым шаблоном, сам шаблон, и часть после шаблона. Если шаблон не найден, возвращается кортеж, содержащий саму строку, а затем две пустых строки

`S.rpartition(sep)` — возвращает кортеж, содержащий часть перед последним шаблоном, сам шаблон, и часть после шаблона. Если шаблон не найден, возвращается кортеж, содержащий две пустых строки, а затем саму строку

`S.swapcase()` — переводит символы нижнего регистра в верхний, а верхнего – в нижний

`S.title()` — первую букву каждого слова переводит в верхний регистр, а все остальные в нижний

`S.zfill(width)` — делает длину строки не меньшей `width`, по необходимости заполняя первые символы нулями

`S.ljust(width, fillchar=" ")` — делает длину строки не меньшей `width`, по необходимости заполняя последние символы символом `fillchar`

`S.rjust(width, fillchar=" ")` — делает длину строки не меньшей `width`, по необходимости заполняя первые символы символом `fillchar`

- `str.format(*args, **kwargs)` — форматирование строки (см. раздел)

## Форматирование строк методом `str.format()`

Если для подстановки требуется только один аргумент, то значение - сам аргумент:
```python
>>> 'Hello, {}!'.format('Vasya')
'Hello, Vasya!'
```
А если несколько, то значениями будут являться все аргументы со строками
подстановки (обычных или именованных):
```python
>>> '{0}, {1}, {2}'.format('a', 'b', 'c')
'a, b, c'

>>> '{}, {}, {}'.format('a', 'b', 'c')
'a, b, c'

>>> '{2}, {1}, {0}'.format('a', 'b', 'c')
'c, b, a'

>>> '{2}, {1}, {0}'.format(*'abc')
'c, b, a'

>>> '{0}{1}{0}'.format('abra', 'cad')
'abracadabra'

>>> 'Coordinates: {latitude}, {longitude}'.format(latitude='37.24N', longitude='-115.81W')
'Coordinates: 37.24N, -115.81W'

>>> coord = {'latitude': '37.24N', 'longitude': '-115.81W'}
>>> 'Coordinates: {latitude}, {longitude}'.format(**coord)
'Coordinates: 37.24N, -115.81W'
```
Однако метод`.format()`умеет большее. Вот его синтаксис:
```python
поле замены     ::=  "{" [имя поля] ["!" преобразование] [":" спецификация] "}"
имя поля        ::=  arg_name ("." имя атрибута | "[" индекс "]")*
преобразование  ::=  "r" (внутреннее представление) | "s" (человеческое представление)
спецификация    ::=  см. ниже
```
Например:
```python
>>> "Units destroyed: {players[0]}".format(players = [1, 2, 3])
'Units destroyed: 1'

>>> "Units destroyed: {players[0]!r}".format(players = ['1', '2', '3'])
"Units destroyed: '1'"
```
Теперь спецификация формата:
```python
спецификация ::=  [[fill]align][sign][#][0][width][,][.precision][type]
заполнитель  ::=  символ кроме '{' или '}'
выравнивание ::=  "<" | ">" | "=" | "^"
знак         ::=  "+" | "-" | " "
ширина       ::=  integer
точность     ::=  integer
тип          ::=  "b" | "c" | "d" | "e" | "E" | "f" | "F" | "g" | "G" |
                  "n" | "o" | "s" | "x" | "X" | "%"
```
Выравнивание производится при помощи символа-заполнителя. Доступны следующие варианты выравнивания:

| Флаг | Значение                                                                                |
|:----:|:----------------------------------------------------------------------------------------|
| '<'  | 	Символы-заполнители будут справа (выравнивание объекта по левому краю) (по умолчанию). |
| '>'  | 	выравнивание объекта по правому краю.                                                  |
| '='  | 	Заполнитель будет после знака, но перед цифрами. Работает только с числовыми типами.   |
| '^'  | 	Выравнивание по центру.                                                                |

Опция "знак" используется только для чисел и может принимать следующие значения:

|   Флаг   | 	Значение                                         |
|:--------:|:--------------------------------------------------|
|   '+'    | 	Знак должен быть использован для всех чисел.     |
|   '-'    | 	'-' для отрицательных, ничего для положительных. |
| 'Пробел' | 	'-' для отрицательных, пробел для положительных. |

Поле "тип" может принимать следующие значения:

|        Тип        | 	Значение                                                                                                                          |
|:-----------------:|:-----------------------------------------------------------------------------------------------------------------------------------|
| `'d'`,`'i'`,`'u'` | 	Десятичное число                                                                                                                  |
|      `'o'`	       | Число в восьмеричной системе счисления                                                                                             |
|      `'x'`	       | Число в шестнадцатеричной системе счисления (буквы в нижнем регистре)                                                              |
|      `'X'`	       | Число в шестнадцатеричной системе счисления (буквы в верхнем регистре)                                                             |
|      `'e'`	       | Число с плавающей точкой с экспонентой (экспонента в нижнем регистре)                                                              |
|      `'E'`	       | Число с плавающей точкой с экспонентой (экспонента в верхнем регистре)                                                             |
|    `'f'`,`'F'`    | 	Число с плавающей точкой (обычный формат)                                                                                         |
|      `'g'`	       | Число с плавающей точкой с экспонентой (экспонента в нижнем регистре), если она меньше, чем -4 или точности, иначе обычный формат  |
|      `'G'`	       | Число с плавающей точкой с экспонентой (экспонента в верхнем регистре), если она меньше, чем -4 или точности, иначе обычный формат |
|      `'c'`	       | Символ (строка из одного символа или число - код символа)                                                                          |
|      `'s'`	       | Строка                                                                                                                             |
|       `'%'`       | Число умножается на 100, отображается число с плавающей точкой, а за ним знак %                                                    |

И напоследок, несколько примеров:
```python
>>> coord = (3, 5)
>>> 'X: {0[0]};  Y: {0[1]}'.format(coord)
'X: 3;  Y: 5'

>>> "repr() shows quotes: {!r}; str() doesn't: {!s}".format('test1', 'test2')
"repr() shows quotes: 'test1'; str() doesn't: test2"

>>> '{:<30}'.format('left aligned')
'left aligned                  '

>>> '{:>30}'.format('right aligned')
'                 right aligned'

>>> '{:^30}'.format('centered')
'           centered           '

>>> '{:*^30}'.format('centered')  # use '*' as a fill char
'***********centered***********'

>>> '{:+f}; {:+f}'.format(3.14, -3.14)  # show it always
'+3.140000; -3.140000'

>>> '{: f}; {: f}'.format(3.14, -3.14)  # show a space for positive numbers
' 3.140000; -3.140000'

>>> '{:-f}; {:-f}'.format(3.14, -3.14)  # show only the minus -- same as '{:f}; {:f}'
'3.140000; -3.140000'

>>> # format also supports binary numbers
>>> "int: {0:d};  hex: {0:x};  oct: {0:o};  bin: {0:b}".format(42)
'int: 42;  hex: 2a;  oct: 52;  bin: 101010'

>>> # with 0x, 0o, or 0b as prefix:
>>> "int: {0:d};  hex: {0:#x};  oct: {0:#o};  bin: {0:#b}".format(42)
'int: 42;  hex: 0x2a;  oct: 0o52;  bin: 0b101010'

>>> points = 19.5
>>> total = 22
>>> 'Correct answers: {:.2%}'.format(points/total)
'Correct answers: 88.64%'
```

## Форматирование строк с помощью оператора`%`

Если для подстановки требуется только один аргумент, то значение - сам аргумент:
```python
>>> 'Hello, %s!' % 'Serhii'
'Hello, Serhii!'
```
А если несколько, то значением будет являться кортеж со строками подстановки:
```python
>>> '%d %s, %d %s' % (6, 'bananas', 10, 'lemons')
'6 bananas, 10 lemons'
```

**Спецификаторы преобразования записываются в следующем порядке:**  

1) `%`.
2) Ключ (опционально), определяет, какой аргумент из значения будет 
подставляться.
3) Флаги преобразования.
4) Минимальная ширина поля. Если`*`, значение берётся из кортежа.
5) Точность, начинается с`.`, затем - желаемая точность.
6) Модификатор длины (опционально).
7) Тип.

### Типы подстановки:

|        Тип        | 	Значение                                                                                                                          |
|:-----------------:|:-----------------------------------------------------------------------------------------------------------------------------------|
| `'d'`,`'i'`,`'u'` | 	Десятичное число                                                                                                                  |
|      `'o'`	       | Число в восьмеричной системе счисления                                                                                             |
|      `'x'`	       | Число в шестнадцатеричной системе счисления (буквы в нижнем регистре)                                                              |
|      `'X'`	       | Число в шестнадцатеричной системе счисления (буквы в верхнем регистре)                                                             |
|      `'e'`	       | Число с плавающей точкой с экспонентой (экспонента в нижнем регистре)                                                              |
|      `'E'`	       | Число с плавающей точкой с экспонентой (экспонента в верхнем регистре)                                                             |
|    `'f'`,`'F'`    | 	Число с плавающей точкой (обычный формат)                                                                                         |
|      `'g'`	       | Число с плавающей точкой с экспонентой (экспонента в нижнем регистре), если она меньше, чем -4 или точности, иначе обычный формат  |
|      `'G'`	       | Число с плавающей точкой с экспонентой (экспонента в верхнем регистре), если она меньше, чем -4 или точности, иначе обычный формат |
|      `'c'`	       | Символ (строка из одного символа или число - код символа)                                                                          |
|      `'r'`	       | Строка (литерал Python)                                                                                                            |
|      `'s'`	       | Строка (как обычно воспринимается пользователем)                                                                                   |
|      `'%%'`       | Знак `%`                                                                                                                           |

```python
>>> print ('%(language)s has %(number)03d quote types.' % {"language": "Python", "number": 2})
Python has 002 quote types.
```

### Флаги преобразования:

| Флаг | 	Значение                                         |
|:----:|:--------------------------------------------------|
| `#`  | 	Значение будет использовать альтернативную форму |
| `0`  | Свободное место будет заполнено нулями            |
| `-`  | Свободное место будет заполнено пробелами справа  |
| ` `	 | Свободное место будет заполнено пробелами справа. |
| `+`  | Свободное место будет заполнено пробелами слева.  |

```python
>>> '%.2s' % 'Hello!'
'He'

>>> '%.*s' % (2, 'Hello!')
'He'

>>> '%-10d' % 25
'25        '

>>> '%+10f' % 25
'+25.000000'

>>> '%+10s' % 'Hello'
'     Hello'
```